import{a as P,b as B,e as V,g as T,i as W,j as L}from"./chunk-ZPEA53GZ.js";import{a as k}from"./chunk-GR2HOQFX.js";import{$ as u,Ba as S,Fa as E,La as h,Na as n,Oa as i,Pa as C,Qa as w,Ra as f,Sa as s,Wa as o,Xa as v,Ya as p,Za as _,_ as d,_a as g,a as b,d as N,ob as I,pb as M,qb as A,ta as c,xa as q}from"./chunk-6W3H5QY7.js";var x=N(k());function D(m,r){if(m&1){let t=w();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td",19)(12,"button",20),f("click",function(){let e=d(t).$implicit,a=s(2);return u(a.editarEquivalencia(e))}),C(13,"i",21),i(),n(14,"button",22),f("click",function(){let e=d(t).$implicit,a=s(2);return u(a.eliminarEquivalencia(e.id))}),C(15,"i",23),i()()()}if(m&2){let t=r.$implicit;c(2),v(t.idAxa),c(2),v(t.nitEdexa),c(2),v(t.idProducto),c(2),v(t.descripcion),c(2),v(t.listaPrecio)}}function z(m,r){if(m&1){let t=w();n(0,"div")(1,"h3",11),o(2,"Lista de Equivalencias"),i(),n(3,"div",3)(4,"div",4)(5,"input",12),g("ngModelChange",function(e){d(t);let a=s();return _(a.filtro.idAxa,e)||(a.filtro.idAxa=e),u(e)}),i()(),n(6,"div",4)(7,"input",13),g("ngModelChange",function(e){d(t);let a=s();return _(a.filtro.idProducto,e)||(a.filtro.idProducto=e),u(e)}),i()(),n(8,"div",4)(9,"input",14),g("ngModelChange",function(e){d(t);let a=s();return _(a.filtro.descripcion,e)||(a.filtro.descripcion=e),u(e)}),i()(),n(10,"div",4)(11,"input",15),g("ngModelChange",function(e){d(t);let a=s();return _(a.filtro.listaPrecio,e)||(a.filtro.listaPrecio=e),u(e)}),i()()(),n(12,"div",16)(13,"table",17)(14,"thead")(15,"tr")(16,"th"),o(17,"ID AXA"),i(),n(18,"th"),o(19,"NIT EDEXA"),i(),n(20,"th"),o(21,"ID Producto"),i(),n(22,"th"),o(23,"Descripci\xF3n"),i(),n(24,"th"),o(25,"Lista Precio"),i(),n(26,"th"),o(27,"Acciones"),i()()(),n(28,"tbody"),E(29,D,16,5,"tr",18),i()()()()}if(m&2){let t=s();c(5),p("ngModel",t.filtro.idAxa),c(2),p("ngModel",t.filtro.idProducto),c(2),p("ngModel",t.filtro.descripcion),c(2),p("ngModel",t.filtro.listaPrecio),c(18),h("ngForOf",t.equivalenciasFiltradas())}}function F(m,r){m&1&&(n(0,"div",24)(1,"p"),o(2,"No se encontraron equivalencias para el NIT ingresado."),i()())}function O(m,r){if(m&1){let t=w();n(0,"div",25)(1,"div",26)(2,"button",27),f("click",function(){d(t);let e=s();return u(e.isEditing=!1)}),o(3,"\xD7"),i(),n(4,"h3",2),o(5,"Editar Equivalencia"),i(),n(6,"div",28)(7,"label",29),o(8,"ID AXA:"),i(),n(9,"input",30),g("ngModelChange",function(e){d(t);let a=s();return _(a.equivalenciaActual.idAxa,e)||(a.equivalenciaActual.idAxa=e),u(e)}),i()(),n(10,"div",28)(11,"label",29),o(12,"NIT Edexa:"),i(),n(13,"input",31),g("ngModelChange",function(e){d(t);let a=s();return _(a.equivalenciaActual.nitEdexa,e)||(a.equivalenciaActual.nitEdexa=e),u(e)}),i()(),n(14,"div",28)(15,"label",29),o(16,"ID Producto:"),i(),n(17,"input",31),g("ngModelChange",function(e){d(t);let a=s();return _(a.equivalenciaActual.idProducto,e)||(a.equivalenciaActual.idProducto=e),u(e)}),i()(),n(18,"div",28)(19,"label",29),o(20,"Descripci\xF3n:"),i(),n(21,"input",31),g("ngModelChange",function(e){d(t);let a=s();return _(a.equivalenciaActual.descripcion,e)||(a.equivalenciaActual.descripcion=e),u(e)}),i()(),n(22,"div",28)(23,"label",29),o(24,"Lista Precio:"),i(),n(25,"input",31),g("ngModelChange",function(e){d(t);let a=s();return _(a.equivalenciaActual.listaPrecio,e)||(a.equivalenciaActual.listaPrecio=e),u(e)}),i()(),n(26,"div",32)(27,"button",33),f("click",function(){d(t);let e=s();return u(e.guardarEdicion())}),C(28,"i",34),o(29," Guardar "),i(),n(30,"button",35),f("click",function(){d(t);let e=s();return u(e.isEditing=!1)}),C(31,"i",36),o(32," Cancelar "),i()()()()}if(m&2){let t=s();c(9),p("ngModel",t.equivalenciaActual.idAxa),c(4),p("ngModel",t.equivalenciaActual.nitEdexa),c(4),p("ngModel",t.equivalenciaActual.idProducto),c(4),p("ngModel",t.equivalenciaActual.descripcion),c(4),p("ngModel",t.equivalenciaActual.listaPrecio)}}var y=class m{constructor(r){this.apiService=r}equivalencias=[];filtro={nitEdexa:"",idAxa:"",idProducto:"",descripcion:"",listaPrecio:""};busquedaRealizada=!1;isEditing=!1;equivalenciaActual=null;buscarPorNit(){if(!this.filtro.nitEdexa.trim()){x.default.fire("Advertencia","Por favor ingrese un NIT para buscar","warning");return}this.apiService.getEquivalenciasPorNit(this.filtro.nitEdexa).subscribe({next:r=>{this.equivalencias=r,this.busquedaRealizada=!0},error:r=>{console.error("\u274C Error al buscar equivalencias:",r),this.equivalencias=[],this.busquedaRealizada=!0}})}equivalenciasFiltradas(){return this.equivalencias.filter(r=>(!this.filtro.idAxa||r.idAxa.toString().toLowerCase().includes(this.filtro.idAxa.toString().toLowerCase()))&&(!this.filtro.nitEdexa||r.nitEdexa.toLowerCase().includes(this.filtro.nitEdexa.toLowerCase()))&&(!this.filtro.idProducto||r.idProducto.toLowerCase().includes(this.filtro.idProducto.toLowerCase()))&&(!this.filtro.descripcion||r.descripcion.toLowerCase().includes(this.filtro.descripcion.toLowerCase()))&&(!this.filtro.listaPrecio||r.listaPrecio.toLowerCase().includes(this.filtro.listaPrecio.toLowerCase())))}editarEquivalencia(r){this.equivalenciaActual=b({},r),this.isEditing=!0}guardarEdicion(){if(!this.equivalenciaActual||!this.equivalenciaActual.id){x.default.fire("Error","No se puede actualizar la equivalencia sin un ID v\xE1lido","error");return}this.apiService.updateEquivalencia(this.equivalenciaActual.id,this.equivalenciaActual).subscribe({next:()=>{x.default.fire("Guardado","Equivalencia actualizada correctamente","success"),this.equivalencias=this.equivalencias.map(r=>r.id===this.equivalenciaActual.id?b({},this.equivalenciaActual):r),this.isEditing=!1},error:r=>{console.error("\u274C Error al actualizar equivalencia:",r),r.status===400?x.default.fire("Error","El ID de la URL no coincide con el de la entidad.","warning"):r.status===409?x.default.fire("Conflicto","Ya existe una equivalencia con el mismo ID AXA y NIT EDEXA.","warning"):r.status===404?x.default.fire("No encontrado","No se encontr\xF3 la equivalencia a actualizar.","error"):x.default.fire("Error","No se pudo actualizar la equivalencia. Intente nuevamente.","error")}})}eliminarEquivalencia(r){x.default.fire({title:"\xBFEliminar equivalencia?",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&this.apiService.deleteEquivalencia(r).subscribe(()=>{x.default.fire("Eliminado","Equivalencia eliminada","success"),this.equivalencias=this.equivalencias.filter(l=>l.id!==r)})})}static \u0275fac=function(t){return new(t||m)(q(L))};static \u0275cmp=S({type:m,selectors:[["app-buscar-item"]],decls:13,vars:4,consts:[[1,"container","mt-4"],[1,"card","shadow-lg","p-4"],[1,"text-center","mb-4"],[1,"row","mb-3"],[1,"col"],["type","text","placeholder","Ingrese NIT",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-auto"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"],["class","text-center text-danger",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[1,"text-center","mb-3"],["type","text","placeholder","Buscar ID AXA",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Buscar Producto",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Buscar Descripci\xF3n",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Buscar Lista Precio",1,"form-control",3,"ngModelChange","ngModel"],[1,"table-responsive",2,"max-height","400px","overflow-y","auto"],[1,"table","table-hover","table-striped"],[4,"ngFor","ngForOf"],[1,"text-center"],[1,"btn","btn-warning","btn-sm","me-2",3,"click"],[1,"bi","bi-pencil-fill"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"bi","bi-trash-fill"],[1,"text-center","text-danger"],[1,"modal-overlay"],[1,"modal-content"],[1,"close-button",3,"click"],[1,"mb-3"],[1,"form-label"],["type","number",1,"form-control",3,"ngModelChange","ngModel"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between"],[1,"btn","btn-success",3,"click"],[1,"bi","bi-save"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-x"]],template:function(t,l){t&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),o(3,"Buscar Equivalencias por NIT"),i(),n(4,"div",3)(5,"div",4)(6,"input",5),g("ngModelChange",function(a){return _(l.filtro.nitEdexa,a)||(l.filtro.nitEdexa=a),a}),i()(),n(7,"div",6)(8,"button",7),f("click",function(){return l.buscarPorNit()}),o(9,"Buscar"),i()()(),E(10,z,30,5,"div",8)(11,F,3,0,"div",9),i()(),E(12,O,33,5,"div",10)),t&2&&(c(6),p("ngModel",l.filtro.nitEdexa),c(4),h("ngIf",l.equivalencias.length>0),c(),h("ngIf",l.busquedaRealizada&&l.equivalencias.length===0),c(),h("ngIf",l.isEditing))},dependencies:[A,I,M,W,P,T,B,V],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;box-shadow:0 0 10px #0003;width:50%;max-width:500px;position:relative}.close-button[_ngcontent-%COMP%]{position:absolute;top:10px;right:15px;background:none;border:none;font-size:24px;cursor:pointer}"]})};export{y as default};
